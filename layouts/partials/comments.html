<script src="https://giscus.app/client.js"
        data-repo="shidowister/ist-md-pc-club-site"
        data-repo-id="R_kgDOQg0ojg"
        data-category="General"
        data-category-id="DIC_kwDOQg0ojs4C0htG"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="ja"
        crossorigin="anonymous"
        async>
</script>

<script>
    // ページ右上の「月/太陽」ボタンを探す
    const themeToggle = document.querySelector('#theme-toggle');

    // ボタンが存在する場合のみ処理を実行
    if (themeToggle) {
        themeToggle.addEventListener('click', () => {
            
            // 0.2秒待つ（PaperModが色を変えるのを待つため）
            setTimeout(() => {
                const iframe = document.querySelector('iframe.giscus-frame');
                if (!iframe) return;

                // 現在、画面が「dark」クラスを持っているか確認
                const isDark = document.body.classList.contains('dark');
                
                // Giscusに送るテーマ名を決定
                // PaperModのダークモードには 'transparent_dark' が馴染みます
                const newTheme = isDark ? 'transparent_dark' : 'light';

                // Giscusに「色を変えろ！」と命令（postMessage）
                iframe.contentWindow.postMessage({
                    giscus: {
                        setConfig: {
                            theme: newTheme
                        }
                    }
                }, 'https://giscus.app');
                
            }, 200); // 200ミリ秒 = 0.2秒
        });
    }
</script>